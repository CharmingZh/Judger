{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h3 class="mb-0">简历预览</h3>
  <div class="d-flex gap-2">
    <a class="btn btn-outline-secondary" href="/dashboard">返回</a>
    <a class="btn btn-primary" href="/resume/{{ resume_id }}/pdf">下载 PDF</a>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body p-4">
    <h2 class="mb-1">{{ resume.contact.name or "Resume" }}</h2>
    <div class="text-muted mb-2">
      {% set parts = [] %}
      {% if resume.contact.email %} {% set _ = parts.append(resume.contact.email) %} {% endif %}
      {% if resume.contact.phone %} {% set _ = parts.append(resume.contact.phone) %} {% endif %}
      {% if resume.contact.location %} {% set _ = parts.append(resume.contact.location) %} {% endif %}
      {% if resume.contact.linkedin %} {% set _ = parts.append(resume.contact.linkedin) %} {% endif %}
      {{ " | ".join(parts) }}
    </div>
    {% if resume.headline %}<div class="mb-3"><b>{{ resume.headline }}</b></div>{% endif %}

    {% if resume.summary %}
      <h5 class="mt-3">Summary</h5>
      <p>{{ resume.summary }}</p>
    {% endif %}

    {% if resume.skills %}
      <h5 class="mt-3">Skills</h5>
      <div class="d-flex flex-wrap gap-2">
        {% for s in resume.skills %}
          <span class="badge bg-secondary">{{ s }}</span>
        {% endfor %}
      </div>
    {% endif %}

    {% if resume.experience %}
      <h5 class="mt-4">Experience</h5>
      {% for e in resume.experience %}
        <div class="mt-3">
          <div class="fw-semibold">{{ e.company }}{% if e.role %} — {{ e.role }}{% endif %}</div>
          <div class="text-muted small">
            {% if e.location %}{{ e.location }}{% endif %}
            {% if e.start or e.end %} | {{ e.start }} - {{ e.end }}{% endif %}
          </div>
          {% if e.bullets %}
            <ul class="mt-2">
              {% for b in e.bullets %}
                <li>{{ b }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
      {% endfor %}
    {% endif %}

    {% if resume.projects %}
      <h5 class="mt-4">Projects</h5>
      {% for p in resume.projects %}
        <div class="mt-3">
          <div class="fw-semibold">{{ p.name }}{% if p.role %} — {{ p.role }}{% endif %}</div>
          <div class="text-muted small">
            {% if p.start or p.end %}{{ p.start }} - {{ p.end }}{% endif %}
            {% if p.link %} | {{ p.link }}{% endif %}
          </div>
          {% if p.bullets %}
            <ul class="mt-2">
              {% for b in p.bullets %}
                <li>{{ b }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
      {% endfor %}
    {% endif %}

    {% if resume.education %}
      <h5 class="mt-4">Education</h5>
      {% for ed in resume.education %}
        <div class="mt-2">
          <div class="fw-semibold">{{ ed.school }}{% if ed.degree %} — {{ ed.degree }}{% endif %}{% if ed.major %}（{{ ed.major }}）{% endif %}</div>
          <div class="text-muted small">{% if ed.start or ed.end %}{{ ed.start }} - {{ ed.end }}{% endif %}</div>
        </div>
      {% endfor %}
    {% endif %}

    {% if resume.certifications %}
      <h5 class="mt-4">Certifications</h5>
      <ul class="mt-2">
        {% for c in resume.certifications %}
          <li>{{ c }}</li>
        {% endfor %}
      </ul>
    {% endif %}

    {% if resume.additional %}
      <h5 class="mt-4">Additional</h5>
      <ul class="mt-2">
        {% for a in resume.additional %}
          <li>{{ a }}</li>
        {% endfor %}
      </ul>
    {% endif %}

  </div>
</div>
{% endblock %}
